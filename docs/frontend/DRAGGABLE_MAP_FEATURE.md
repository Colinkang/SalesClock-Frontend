# âœ… å¯æ‹–åŠ¨åœ°å›¾ç­¾åˆ°åŠŸèƒ½å®Œæˆ

## ğŸ¯ åŠŸèƒ½è¯´æ˜

### æ ¸å¿ƒç‰¹æ€§
- âœ… GPS å®šä½è·å–
- âœ… å¯æ‹–åŠ¨çš„å°çº¢æ——æ ‡è®°
- âœ… 500ç±³èŒƒå›´é™åˆ¶
- âœ… å®æ—¶è·ç¦»æ˜¾ç¤º
- âœ… å¤šä¸ªåœ°å›¾æœåŠ¡æ”¯æŒ

## ğŸ—ºï¸ åœ°å›¾åŠŸèƒ½

### 1. åˆå§‹å®šä½
ç”¨æˆ·ç‚¹å‡»ç­¾åˆ°åï¼š
1. è‡ªåŠ¨è·å– GPS ä½ç½®
2. åœ¨åœ°å›¾ä¸Šæ˜¾ç¤ºå°çº¢æ——æ ‡è®°
3. æ˜¾ç¤ºå½“å‰ä½ç½®åæ ‡

### 2. æ‰‹åŠ¨è°ƒæ•´ä½ç½®
ç”¨æˆ·å¯ä»¥åœ¨ 500 ç±³èŒƒå›´å†…ï¼š
- âœ… ç‚¹å‡»åœ°å›¾è°ƒæ•´ä½ç½®
- âœ… å®æ—¶æ›´æ–°æ ‡è®°ä½ç½®
- âœ… æ˜¾ç¤ºå½“å‰è·ç¦»åŸå§‹ä½ç½®çš„è·ç¦»
- âš ï¸ è¶…å‡ºèŒƒå›´æ—¶æ˜¾ç¤ºè­¦å‘Š

### 3. è·ç¦»é™åˆ¶

**å®ç°é€»è¾‘**:
```typescript
// è®¡ç®—ä¸¤ç‚¹é—´è·ç¦»ï¼ˆç±³ï¼‰
function calculateDistance(lat1, lng1, lat2, lng2) {
  const R = 6371000; // åœ°çƒåŠå¾„
  // ä½¿ç”¨ Haversine å…¬å¼è®¡ç®—
  // ...è¿”å›è·ç¦»ï¼ˆç±³ï¼‰
}
```

**èŒƒå›´æ£€æŸ¥**:
- âœ… åœ¨ 500m èŒƒå›´å†…ï¼šæ˜¾ç¤ºç»¿è‰²æç¤º âœ…
- âš ï¸ è¶…å‡º 500mï¼šæ˜¾ç¤ºçº¢è‰²è­¦å‘Š âš ï¸
- ğŸš« ä¸å…è®¸æäº¤è¶…å‡ºèŒƒå›´çš„ä½ç½®

## ğŸ¨ ç”¨æˆ·ç•Œé¢

### è·ç¦»æç¤º
```
âœ… è·ç¦»å…è®¸èŒƒå›´: 234m / 500m  (åœ¨èŒƒå›´å†…)
âš ï¸  è·ç¦»å…è®¸èŒƒå›´: 567m / 500m  (è¶…å‡ºèŒƒå›´)
```

### æ‹–åŠ¨æç¤º
ç‚¹å‡»åœ°å›¾æ—¶ä¼šæ˜¾ç¤ºè¦†ç›–å±‚ï¼š
```
ç‚¹å‡»åœ°å›¾è°ƒæ•´ä½ç½®ï¼ˆ500mèŒƒå›´å†…ï¼‰
```

### åœ°å›¾æœåŠ¡é“¾æ¥
æä¾› 4 ç§åœ°å›¾æœåŠ¡é€‰é¡¹ï¼š
- **Google åœ°å›¾** - å…¨çƒè¦†ç›–
- **ç™¾åº¦åœ°å›¾** - ä¸­å›½åœ°åŒº
- **é«˜å¾·åœ°å›¾** - ä¸»è¦æ˜¾ç¤ºï¼ˆä¸­å›½ä¼˜åŒ–ï¼‰
- **OpenStreetMap** - å¼€æºåœ°å›¾

## ğŸ”§ æŠ€æœ¯å®ç°

### DraggableMap ç»„ä»¶

**æ–‡ä»¶**: `src/components/DraggableMap.tsx`

**Props**:
```typescript
interface DraggableMapProps {
  latitude: number;           // å½“å‰çº¬åº¦
  longitude: number;          // å½“å‰ç»åº¦
  initialLat: number;         // åˆå§‹çº¬åº¦ï¼ˆGPSè·å–ï¼‰
  initialLng: number;         // åˆå§‹ç»åº¦ï¼ˆGPSè·å–ï¼‰
  onLocationChange: (lat: number, lng: number) => void;  // ä½ç½®å˜åŒ–å›è°ƒ
  maxDistanceMeters: number;  // æœ€å¤§å…è®¸è·ç¦»ï¼ˆç±³ï¼‰
}
```

### è·ç¦»è®¡ç®—

ä½¿ç”¨ **Haversine å…¬å¼** è®¡ç®—çƒé¢è·ç¦»ï¼š

```typescript
function calculateDistance(lat1, lng1, lat2, lng2) {
  const R = 6371000; // åœ°çƒåŠå¾„ï¼ˆç±³ï¼‰
  const dLat = (lat2 - lat1) * Math.PI / 180;
  const dLng = (lng2 - lng1) * Math.PI / 180;
  const a = 
    Math.sin(dLat / 2) * Math.sin(dLat / 2) +
    Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
    Math.sin(dLng / 2) * Math.sin(dLng / 2);
  const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
  return R * c;
}
```

### ä½ç½®æ›´æ–°

```typescript
const handleMapClick = (e: React.MouseEvent<HTMLDivElement>) => {
  // è·å–ç‚¹å‡»ä½ç½®
  const rect = mapContainerRef.current.getBoundingClientRect();
  const x = e.clientX - rect.left;
  const y = e.clientY - rect.top;
  
  // è½¬æ¢ä¸ºç»çº¬åº¦
  const scale = 0.001;
  const newLat = currentLocation.lat + (y - rect.height / 2) * scale;
  const newLng = currentLocation.lng + (x - rect.width / 2) * scale;
  
  // æ£€æŸ¥è·ç¦»
  const dist = calculateDistance(initialLat, initialLng, newLat, newLng);
  
  if (dist <= maxDistanceMeters) {
    setCurrentLocation({ lat: newLat, lng: newLng });
    onLocationChange(newLat, newLng);
  }
};
```

## ğŸ“± ä½¿ç”¨æµç¨‹

### ç­¾åˆ°æµç¨‹
1. **ç‚¹å‡»ç­¾åˆ°æŒ‰é’®**
2. **è·å– GPS ä½ç½®** - ç³»ç»Ÿè‡ªåŠ¨è·å–å½“å‰ä½ç½®
3. **æ˜¾ç¤ºåœ°å›¾** - åœ°å›¾ä¸Šæ˜¾ç¤ºå°çº¢æ——æ ‡è®°
4. **è°ƒæ•´ä½ç½®ï¼ˆå¯é€‰ï¼‰** - ç‚¹å‡»åœ°å›¾åœ¨ 500m èŒƒå›´å†…è°ƒæ•´
5. **ç¡®è®¤ä½ç½®** - æ£€æŸ¥è·ç¦»æç¤ºï¼Œç¡®è®¤ä½ç½®
6. **æ‹æ‘„ç…§ç‰‡** - æ·»åŠ ç°åœºç…§ç‰‡
7. **æäº¤ç­¾åˆ°** - å®Œæˆç­¾åˆ°

### ä½ç½®è°ƒæ•´
- ç”¨æˆ·å¯ä»¥åœ¨ 500 ç±³èŒƒå›´å†…è‡ªç”±è°ƒæ•´ä½ç½®
- å®æ—¶æ˜¾ç¤ºè·ç¦»åŸå§‹ GPS ä½ç½®çš„è·ç¦»
- è¶…å‡ºèŒƒå›´æ—¶æ˜¾ç¤ºè­¦å‘Šï¼Œä½†ä»å¯è°ƒæ•´

## ğŸ”’ å®‰å…¨è€ƒè™‘

### èŒƒå›´é™åˆ¶
- é˜²æ­¢è¿œç¨‹ç­¾åˆ°ï¼ˆè¶…å‡º 500m èŒƒå›´ï¼‰
- åŸºäº GPS çš„åˆå§‹ä½ç½®éªŒè¯
- å®æ—¶è·ç¦»è®¡ç®—å’Œæç¤º

### ç”¨æˆ·ä½“éªŒ
- æ¸…æ™°çš„è§†è§‰åé¦ˆ
- å®æ—¶è·ç¦»æ˜¾ç¤º
- å¤šä¸ªåœ°å›¾æœåŠ¡å¤‡ç”¨
- å“åº”å¼è®¾è®¡

## âœ… å®ŒæˆçŠ¶æ€

- âœ… å¯æ‹–åŠ¨åœ°å›¾æ ‡è®°
- âœ… 500 ç±³èŒƒå›´é™åˆ¶
- âœ… å®æ—¶è·ç¦»æ˜¾ç¤º
- âœ… èŒƒå›´è­¦å‘Šæç¤º
- âœ… å¤šä¸ªåœ°å›¾æœåŠ¡æ”¯æŒ
- âœ… å“åº”å¼ç•Œé¢è®¾è®¡

**ç­¾åˆ°åŠŸèƒ½ç°åœ¨æ”¯æŒæ‰‹åŠ¨è°ƒæ•´ä½ç½®ï¼Œå¹¶ç¡®ä¿ç”¨æˆ·åœ¨åˆç†çš„ç­¾åˆ°èŒƒå›´å†…ï¼**
